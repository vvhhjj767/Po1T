<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Live Election Control Room</title>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&family=Oswald:wght@500;700&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --bg-dark: #0f172a;
            --bg-panel: #1e293b;
            --border: #334155;
            --highlight: #3b82f6;
            --danger: #ef4444;
            --success: #22c55e;
            --text-main: #f8fafc;
            --text-muted: #94a3b8;
            --font-main: 'Inter', sans-serif;
            --font-head: 'Oswald', sans-serif;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }
        
        body {
            font-family: var(--font-main);
            background: var(--bg-dark);
            color: var(--text-main);
            height: 100vh;
            overflow: hidden;
            display: flex;
        }

        /* --- LAYOUT --- */
        #app {
            display: flex;
            width: 100%;
            height: 100%;
        }

        .layout-container {
            display: flex;
            width: 100%;
            height: 100%;
        }

        /* LEFT: DIRECTOR PANEL */
        .director-panel {
            width: 40%;
            background: var(--bg-panel);
            border-right: 1px solid var(--border);
            display: flex;
            flex-direction: column;
            transition: width 0.3s ease, transform 0.3s ease;
            z-index: 100;
        }

        .director-panel.hidden {
            width: 0;
            overflow: hidden;
            border: none;
        }

        .panel-header {
            padding: 1rem;
            background: rgba(0,0,0,0.2);
            border-bottom: 1px solid var(--border);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .scroll-area {
            flex: 1;
            overflow-y: auto;
            padding: 1rem;
        }

        /* RIGHT: ON-AIR DISPLAY */
        .on-air-panel {
            flex: 1;
            background: #000;
            position: relative;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            overflow: hidden;
        }

        .broadcast-toggle {
            position: absolute;
            top: 1rem;
            left: 1rem;
            z-index: 500;
            background: var(--highlight);
            border: none;
            color: white;
            padding: 0.5rem 1rem;
            cursor: pointer;
            border-radius: 4px;
            font-weight: bold;
            opacity: 0.5;
            transition: opacity 0.2s;
        }
        .broadcast-toggle:hover { opacity: 1; }

        /* --- DIRECTOR CONTROLS --- */
        .control-group {
            background: rgba(255,255,255,0.05);
            padding: 1rem;
            border-radius: 8px;
            margin-bottom: 1rem;
        }

        .control-title {
            font-size: 0.8rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: var(--text-muted);
            margin-bottom: 0.5rem;
            font-weight: bold;
        }

        .scene-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 0.5rem;
        }

        .scene-btn {
            background: var(--bg-dark);
            border: 1px solid var(--border);
            color: var(--text-muted);
            padding: 1rem;
            cursor: pointer;
            border-radius: 6px;
            transition: all 0.2s;
            text-align: center;
            font-weight: bold;
        }

        .scene-btn.active {
            background: var(--highlight);
            color: white;
            border-color: var(--highlight);
            box-shadow: 0 0 10px rgba(59, 130, 246, 0.5);
        }

        .party-card {
            background: var(--bg-dark);
            border: 1px solid var(--border);
            padding: 1rem;
            border-radius: 6px;
            margin-bottom: 0.5rem;
            display: grid;
            gap: 0.5rem;
        }

        .party-header {
            display: flex;
            gap: 0.5rem;
            align-items: center;
        }

        .color-picker {
            width: 30px;
            height: 30px;
            border: none;
            background: none;
            cursor: pointer;
        }

        .input-text {
            background: rgba(255,255,255,0.1);
            border: 1px solid var(--border);
            color: white;
            padding: 0.5rem;
            border-radius: 4px;
            width: 100%;
        }

        .seat-controls {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
        }

        .seat-control-group {
            text-align: center;
            background: rgba(255,255,255,0.05);
            padding: 0.5rem;
            border-radius: 4px;
        }

        .seat-btn-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 5px;
        }

        .btn-circle {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            border: none;
            cursor: pointer;
            font-weight: bold;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .btn-minus { background: #475569; color: white; }
        .btn-plus { background: var(--success); color: black; }

        /* --- VISUALIZATIONS (ON AIR) --- */
        .on-air-container {
            width: 100%;
            height: 100%;
            position: relative;
            background: radial-gradient(circle at center, #1e293b 0%, #020617 100%);
            padding: 2rem;
            display: flex;
            flex-direction: column;
        }

        .live-badge {
            position: absolute;
            top: 2rem;
            right: 2rem;
            background: var(--danger);
            color: white;
            padding: 0.25rem 0.75rem;
            font-weight: bold;
            border-radius: 4px;
            font-family: var(--font-head);
            letter-spacing: 1px;
            animation: pulse 2s infinite;
        }

        /* Scene: Table */
        .rank-list {
            width: 80%;
            max-width: 1000px;
            margin: auto;
        }
        .rank-row {
            display: grid;
            grid-template-columns: 50px 1fr 100px 100px 150px;
            align-items: center;
            background: rgba(255,255,255,0.05);
            margin-bottom: 0.5rem;
            padding: 1rem;
            border-radius: 8px;
            font-size: 1.5rem;
            border-left: 8px solid transparent;
        }
        .rank-row-move { transition: transform 0.5s; }

        /* Scene: Hemicycle */
        .hemicycle-container {
            width: 100%;
            height: 80%;
            position: relative;
            display: flex;
            justify-content: center;
            align-items: flex-end;
            padding-bottom: 50px;
        }
        .seat-dot {
            position: absolute;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            transition: background-color 0.5s ease;
            box-shadow: 0 0 5px rgba(0,0,0,0.5);
        }

        /* Scene: Donut */
        .donut-container {
            width: 100%;
            height: 80%;
            display: flex;
            justify-content: center;
            align-items: center;
            position: relative;
        }
        svg.donut-chart {
            transform: rotate(-90deg);
            width: 600px;
            height: 600px;
        }
        .donut-center-text {
            position: absolute;
            text-align: center;
        }

        /* Scene: Top 3 */
        .top3-container {
            display: flex;
            justify-content: center;
            align-items: flex-end;
            gap: 2rem;
            height: 70%;
            width: 100%;
        }
        .podium {
            width: 250px;
            background: linear-gradient(to bottom, #1e293b, #0f172a);
            border-radius: 12px 12px 0 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 2rem;
            position: relative;
            border-top: 8px solid;
            transition: height 0.5s ease;
        }
        .podium.rank-1 { height: 100%; z-index: 10; transform: scale(1.1); box-shadow: 0 0 30px rgba(0,0,0,0.5); }
        .podium.rank-2 { height: 80%; }
        .podium.rank-3 { height: 60%; }

        /* Scene: Grid */
        .grid-container {
            display: flex;
            flex-wrap: wrap;
            width: 900px;
            gap: 4px;
            margin: auto;
            justify-content: center;
        }
        .grid-block {
            width: 14px;
            height: 14px;
            border-radius: 2px;
            background: #334155;
            transition: background 0.3s;
        }

        /* Ticker */
        .ticker-bar {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 60px;
            background: #fbbf24;
            color: #000;
            display: flex;
            align-items: center;
            overflow: hidden;
            border-top: 4px solid #fff;
        }
        .ticker-label {
            background: #b91c1c;
            color: white;
            height: 100%;
            padding: 0 2rem;
            display: flex;
            align-items: center;
            font-family: var(--font-head);
            font-weight: bold;
            font-size: 1.5rem;
            z-index: 10;
            box-shadow: 5px 0 10px rgba(0,0,0,0.3);
        }
        .marquee {
            white-space: nowrap;
            overflow: hidden;
            display: inline-block;
            animation: marquee 20s linear infinite;
            padding-left: 100%;
            font-size: 1.5rem;
            font-weight: bold;
            text-transform: uppercase;
        }

        @keyframes marquee {
            0% { transform: translate(0, 0); }
            100% { transform: translate(-100%, 0); }
        }
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }

        /* Typography Utilities */
        .text-big { font-size: 4rem; font-family: var(--font-head); font-weight: 700; }
        .text-party { font-size: 1.5rem; font-weight: bold; margin-top: 1rem; }
        .text-sub { color: var(--text-muted); font-size: 1rem; }

        .fade-enter-active, .fade-leave-active { transition: opacity 0.5s ease; }
        .fade-enter-from, .fade-leave-to { opacity: 0; }
        
        .slide-up-enter-active { transition: all 0.5s ease-out; }
        .slide-up-enter-from { opacity: 0; transform: translateY(50px); }
        
    </style>
</head>
<body>

<div id="app">
    <div class="layout-container">
        
        <div class="director-panel" :class="{ hidden: !showDirector }">
            <div class="panel-header">
                <h1 style="font-family: var(--font-head);">DIRECTOR CONTROL</h1>
                <div style="font-size: 0.8rem; text-align: right;">
                    <div>TOTAL: {{ totalAllocated }}/500</div>
                    <div :style="{ color: remainingSeats < 0 ? 'var(--danger)' : 'var(--success)' }">
                        REMAINING: {{ remainingSeats }}
                    </div>
                </div>
            </div>

            <div class="scroll-area">
                
                <div class="control-group">
                    <div class="control-title">Live Scene Selection</div>
                    <div class="scene-grid">
                        <div v-for="scene in scenes" 
                             :key="scene.id" 
                             class="scene-btn" 
                             :class="{ active: activeScene === scene.id }"
                             @click="activeScene = scene.id">
                            {{ scene.name }}
                        </div>
                    </div>
                </div>

                <div class="control-group">
                    <div class="control-title">Breaking News Ticker</div>
                    <input type="text" v-model="tickerText" class="input-text" style="margin-bottom: 0.5rem;">
                    <button class="scene-btn" 
                            :class="{ active: showTicker }" 
                            @click="showTicker = !showTicker"
                            style="width: 100%;">
                        {{ showTicker ? 'TICKER ON AIR' : 'TICKER HIDDEN' }}
                    </button>
                </div>

                <div class="control-group">
                    <div class="control-title">Party Management</div>
                    <div v-for="party in parties" :key="party.id" class="party-card">
                        <div class="party-header">
                            <input type="color" v-model="party.color" class="color-picker">
                            <input type="text" v-model="party.name" class="input-text">
                            <button @click="removeParty(party.id)" style="background:none; border:none; color:var(--danger); cursor:pointer;">✖</button>
                        </div>
                        
                        <div class="seat-controls">
                            <div class="seat-control-group">
                                <div class="text-sub" style="font-size:0.7rem;">DISTRICT</div>
                                <div style="font-size:1.2rem; font-weight:bold;">{{ party.district }}</div>
                                <div class="seat-btn-row">
                                    <button class="btn-circle btn-minus" @click="updateSeats(party, 'district', -1)">-</button>
                                    <button class="btn-circle btn-plus" @click="updateSeats(party, 'district', 1)">+</button>
                                </div>
                            </div>
                            <div class="seat-control-group">
                                <div class="text-sub" style="font-size:0.7rem;">P-LIST</div>
                                <div style="font-size:1.2rem; font-weight:bold;">{{ party.list }}</div>
                                <div class="seat-btn-row">
                                    <button class="btn-circle btn-minus" @click="updateSeats(party, 'list', -1)">-</button>
                                    <button class="btn-circle btn-plus" @click="updateSeats(party, 'list', 1)">+</button>
                                </div>
                            </div>
                        </div>
                        <div style="text-align:right; font-weight:bold; color: var(--highlight);">
                            TOTAL: {{ party.district + party.list }}
                        </div>
                    </div>
                    
                    <button @click="addParty" class="scene-btn" style="width:100%; margin-top:1rem; border-style:dashed;">
                        + ADD NEW PARTY
                    </button>
                </div>

            </div>
        </div>

        <div class="on-air-panel">
            <button class="broadcast-toggle" @click="showDirector = !showDirector">
                {{ showDirector ? 'HIDE UI' : 'SHOW UI' }}
            </button>
            
            <div class="on-air-container">
                <div class="live-badge">LIVE RESULTS</div>

                <transition name="slide-up" mode="out-in">
                    <div v-if="activeScene === 'table'" class="rank-list" key="table">
                        <h1 class="text-big" style="text-align:center; margin-bottom:2rem;">SEAT COUNT</h1>
                        <transition-group name="rank-list">
                            <div v-for="(party, index) in sortedParties" :key="party.id" class="rank-row" :style="{ borderLeftColor: party.color }">
                                <div style="color:var(--text-muted)">#{{ index + 1 }}</div>
                                <div style="font-weight:bold;">{{ party.name }}</div>
                                <div style="text-align:center; font-family:monospace; color:var(--text-muted)">{{ party.district }}</div>
                                <div style="text-align:center; font-family:monospace; color:var(--text-muted)">{{ party.list }}</div>
                                <div style="text-align:right; font-weight:bold; font-size:2rem; color:white;">
                                    {{ party.district + party.list }}
                                </div>
                            </div>
                        </transition-group>
                    </div>

                    <div v-else-if="activeScene === 'hemicycle'" class="hemicycle-container" key="hemicycle">
                        <h1 class="text-big" style="position:absolute; top: 0;">PARLIAMENT</h1>
                        <div v-for="(dot, i) in hemicycleDots" 
                             :key="i" 
                             class="seat-dot"
                             :style="{ 
                                 left: dot.x + 'px', 
                                 bottom: dot.y + 'px', 
                                 backgroundColor: dot.color 
                             }">
                        </div>
                        <div style="position:absolute; bottom: 0; text-align:center;">
                            <div class="text-big">{{ totalAllocated }}</div>
                            <div class="text-sub">SEATS FILLED</div>
                        </div>
                    </div>

                    <div v-else-if="activeScene === 'top3'" class="top3-container" key="top3">
                        <div v-for="(party, i) in top3Parties" :key="party.id" 
                             class="podium" 
                             :class="'rank-' + (i+1)"
                             :style="{ borderTopColor: party.color }">
                             <div class="text-big" :style="{ color: party.color }">{{ party.district + party.list }}</div>
                             <div class="text-sub">SEATS</div>
                             <div class="text-party" :style="{ color: party.color }">{{ party.name }}</div>
                             <div style="margin-top:auto; font-size:3rem; opacity:0.1; font-weight:900;">{{ i+1 }}</div>
                        </div>
                    </div>

                    <div v-else-if="activeScene === 'donut'" class="donut-container" key="donut">
                        <svg viewBox="0 0 100 100" class="donut-chart">
                            <circle v-for="(segment, i) in donutSegments" 
                                    :key="i"
                                    cx="50" cy="50" r="40"
                                    fill="transparent"
                                    :stroke="segment.color"
                                    stroke-width="15"
                                    :stroke-dasharray="segment.dash"
                                    :stroke-dashoffset="segment.offset"
                                    style="transition: stroke-dasharray 1s ease, stroke-dashoffset 1s ease;"
                            />
                        </svg>
                        <div class="donut-center-text">
                            <div class="text-big">{{ totalAllocated }}</div>
                            <div class="text-sub">OF 500</div>
                        </div>
                        <div style="position:absolute; right:0; top:20%;">
                            <div v-for="party in sortedParties.slice(0,5)" :key="party.id" style="display:flex; gap:10px; margin-bottom:10px; align-items:center;">
                                <div :style="{background: party.color}" style="width:20px; height:20px; border-radius:4px;"></div>
                                <div>{{ party.name }}: <b>{{ party.district + party.list }}</b></div>
                            </div>
                        </div>
                    </div>

                    <div v-else-if="activeScene === 'grid'" key="grid">
                        <h1 class="text-big" style="text-align:center; margin-bottom:20px;">SEAT MAP</h1>
                        <div class="grid-container">
                            <div v-for="(color, i) in gridSeats" 
                                 :key="i" 
                                 class="grid-block"
                                 :style="{ backgroundColor: color }">
                            </div>
                        </div>
                        <div style="text-align:center; margin-top:20px; color:var(--text-muted);">
                            MAJORITY: 251
                        </div>
                    </div>

                </transition>

                <transition name="fade">
                    <div v-if="showTicker" class="ticker-bar">
                        <div class="ticker-label">BREAKING</div>
                        <div class="marquee" :style="{ animationDuration: (200 / tickerSpeed) + 's' }">
                            {{ tickerText }} &nbsp;&nbsp;&nbsp; • &nbsp;&nbsp;&nbsp; {{ tickerText }}
                        </div>
                    </div>
                </transition>
            </div>
        </div>

    </div>
</div>

<script>
    const { createApp } = Vue;

    createApp({
        data() {
            return {
                showDirector: true,
                activeScene: 'table', // table, hemicycle, top3, donut, grid
                showTicker: true,
                tickerText: "POLLS CLOSED AT 5:00 PM • COUNTING UNDERWAY • VOTER TURNOUT ESTIMATED AT 75%",
                tickerSpeed: 10,
                
                // DATA MODEL
                MAX_SEATS: 500,
                MAX_DISTRICT: 400,
                MAX_LIST: 100,
                
                parties: [
                    { id: 1, name: "People's Vision", color: "#f97316", district: 140, list: 25 },
                    { id: 2, name: "National Pride", color: "#1d4ed8", district: 110, list: 20 },
                    { id: 3, name: "Liberal Union", color: "#dc2626", district: 55, list: 12 },
                    { id: 4, name: "Green Future", color: "#16a34a", district: 28, list: 5 },
                    { id: 5, name: "Democratic Front", color: "#9333ea", district: 10, list: 2 },
                ],
                
                scenes: [
                    { id: 'table', name: 'Rank Table' },
                    { id: 'hemicycle', name: 'Parliament' },
                    { id: 'top3', name: 'Top 3 Lead' },
                    { id: 'donut', name: 'Donut Chart' },
                    { id: 'grid', name: '500 Grid' }
                ]
            }
        },
        computed: {
            totalAllocated() {
                return this.parties.reduce((sum, p) => sum + p.district + p.list, 0);
            },
            remainingSeats() {
                return this.MAX_SEATS - this.totalAllocated;
            },
            sortedParties() {
                // Return copy sorted by total seats desc
                return [...this.parties].sort((a,b) => (b.district + b.list) - (a.district + a.list));
            },
            top3Parties() {
                // Specifically for the podium view, we need exactly 3 items.
                // If fewer than 3 parties, fill with dummy or handle logic.
                const sorted = this.sortedParties;
                // Podium order: 2nd, 1st, 3rd (Left, Center, Right) visually
                // But in array we just return top 3, template handles visual placement logic
                // Actually, let's just return top 3 sorted 1,2,3.
                // The template uses flexbox. We need to reorder specifically for the podium visual?
                // Visual Order in CSS: Rank 2, Rank 1, Rank 3
                // We will render normally and use order property or just structural placement
                // Let's just return the top 3 sorted 1, 2, 3
                return sorted.slice(0, 3);
            },
            
            // --- VISUALIZATION DATA GENERATORS ---
            
            hemicycleDots() {
                // Generate 500 coordinates for an arch
                const dots = [];
                const total = 500;
                // We map the sorted parties to colors
                let seatColors = [];
                this.sortedParties.forEach(p => {
                    const count = p.district + p.list;
                    for(let i=0; i<count; i++) seatColors.push(p.color);
                });
                
                // Arch math
                const rows = 12;
                const r_inner = 150;
                const r_step = 25;
                const center_x = 0; // Relative to container center
                
                let count = 0;
                // We fill from bottom left to bottom right? 
                // Usually Hemicycle fills from left to right in sectors.
                // For simplicity, we just fill the pre-calculated positions with the color array.
                
                // Let's generate positions first
                let positions = [];
                for(let r=0; r<rows; r++) {
                    const radius = r_inner + (r * r_step);
                    const arcLen = Math.PI * radius;
                    const seatsInRow = Math.floor(arcLen / 15); // spacing
                    
                    for(let s=0; s<seatsInRow; s++) {
                        if(positions.length >= 500) break;
                        // angle 180 to 0
                        const theta = Math.PI - (s / (seatsInRow-1)) * Math.PI;
                        const x = radius * Math.cos(theta);
                        const y = radius * Math.sin(theta);
                        positions.push({x, y});
                    }
                }
                
                // Fix positions to center in container (assume 800px width container)
                const centerX = 400; // rough center offset, CSS handles real centering
                
                return positions.map((pos, i) => ({
                    x: pos.x, // CSS will center this relative to container
                    y: pos.y,
                    color: seatColors[i] || '#334155' // Default grey
                }));
            },
            
            gridSeats() {
                let colors = [];
                this.sortedParties.forEach(p => {
                    for(let i=0; i<(p.district + p.list); i++) colors.push(p.color);
                });
                while(colors.length < 500) colors.push('#334155');
                return colors;
            },
            
            donutSegments() {
                // Calculate stroke-dasharray for SVG
                // Circumference = 2 * PI * 40 ≈ 251.32
                const c = 251.32;
                let offset = 0;
                const segments = [];
                
                this.sortedParties.forEach(p => {
                    const total = p.district + p.list;
                    const val = (total / 500) * c;
                    segments.push({
                        color: p.color,
                        dash: `${val} ${c}`,
                        offset: -offset
                    });
                    offset += val;
                });
                
                // Remainder (Grey)
                if(this.totalAllocated < 500) {
                    const rem = ((500 - this.totalAllocated) / 500) * c;
                    segments.push({
                        color: '#334155',
                        dash: `${rem} ${c}`,
                        offset: -offset
                    });
                }
                
                return segments;
            }
        },
        methods: {
            addParty() {
                const id = Date.now();
                this.parties.push({
                    id,
                    name: "New Party",
                    color: "#94a3b8",
                    district: 0,
                    list: 0
                });
            },
            removeParty(id) {
                this.parties = this.parties.filter(p => p.id !== id);
            },
            updateSeats(party, type, change) {
                // Predictive check
                const currentTotal = this.totalAllocated;
                const pTotal = party.district + party.list;
                
                if (change > 0 && currentTotal >= this.MAX_SEATS) return;
                
                if (type === 'district') {
                    const newVal = party.district + change;
                    if (newVal >= 0 && newVal <= this.MAX_DISTRICT) party.district = newVal;
                } else {
                    const newVal = party.list + change;
                    if (newVal >= 0 && newVal <= this.MAX_LIST) party.list = newVal;
                }
            }
        }
    }).mount('#app')
</script>

</body>
</html>
